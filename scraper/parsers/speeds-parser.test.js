const speedsParser = require('./speeds-parser');

it('parse speeds from treerazer', () => {
  const input = `<b>Speed</b> 60 feet, fly 60 feet, swim 40 feet; <a style="text-decoration:underline" href="Spells.aspx?ID=128"><i>freedom of movement</i></a><br /><span class="hanging-indent"><b>Melee</b> <img class="actiondark" alt="Single Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\OneAction.png"><img class="actionlight" alt="Single Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\OneAction_I.png"> <i>Blackaxe</i> +47 [<a style="text-decoration:underline" href="Rules.aspx?ID=322"><u>+42/+37</u></a>] (<a href="Traits.aspx?ID=3"><u>acid</a></u>, <a href="Traits.aspx?ID=25"><u>chaotic</a></u>, <a href="Traits.aspx?ID=64"><u>evil</a></u>, <a href="Traits.aspx?ID=103"><u>magical</a></u>, <a href="Traits.aspx?ID=192"><u>reach 15 feet</a></u>, <a href="Traits.aspx?ID=194"><u>sweep</a></u>), <b>Damage</b> 4d12+15 slashing plus 1d6 acid, 1d6 chaotic, and 1d6 evil, and 2d6 slashing vs. plants</span><span class="hanging-indent"><b>Melee</b> <img class="actiondark" alt="Single Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\OneAction.png"><img class="actionlight" alt="Single Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\OneAction_I.png"> jaws +45 [<a style="text-decoration:underline" href="Rules.aspx?ID=322"><u>+41/+37</u></a>] (<a href="Traits.aspx?ID=170"><u>agile</a></u>, <a href="Traits.aspx?ID=25"><u>chaotic</a></u>, <a href="Traits.aspx?ID=64"><u>evil</a></u>, <a href="Traits.aspx?ID=103"><u>magical</a></u>, <a href="Traits.aspx?ID=192"><u>reach 15 feet</a></u>), <b>Damage</b> 4d10+18 slashing plus 2d6 chaotic and 2d6 evil</span><b>Primal Innate Spells</b> DC 49, attack +43; <b>10th</b> <i><u><a href="Spells.aspx?ID=152">horrid wilting</a></u></i>, <i><u><a href="Spells.aspx?ID=339">time stop</a></u></i>, <i><u><a href="Spells.aspx?ID=366">wall of thorns</a></u></i>; <b>9th</b> <i><u><a href="Spells.aspx?ID=492">abyssal wrath</a></u></i> (at will), <i><u><a href="Spells.aspx?ID=78">dispel magic</a></u></i> (at will); <b>6th</b> <i><u><a href="Spells.aspx?ID=331">tangling creepers</a></u></i> (at will); <b>5th</b> <i><u><a href="Spells.aspx?ID=1">abyssal plague</a></u></i> (at will); <b>3rd</b> <i><u><a href="Spells.aspx?ID=94">earthbind</a></u></i> (at will); <b>2nd</b> <i><u><a href="Spells.aspx?ID=333">telekinetic maneuver</a></u></i> (at will); <b>Cantrips</b> <b>(9th)</b> <i><u><a href="Spells.aspx?ID=334">telekinetic projectile</a></u></i>; <b>Constant</b> <b>(8th)</b> <i><u><a href="Spells.aspx?ID=344">true seeing</a></u></i>; <b>(4th)</b> <i><u><a href="Spells.aspx?ID=128">freedom of movement</a></u></i><br /><b>Primal Rituals</b> DC 49; <b>5th</b> <i><u><a href="Rituals.aspx?ID=16">planar ally</a></u></i>; <b>1st</b> <i><u><a href="Rituals.aspx?ID=21">abyssal pact</a></u></i><br /><span class="hanging-indent"><b>Defoliation</b> <img class="actiondark" alt="Two Actions" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\TwoActions.png"><img class="actionlight" alt="Two Actions" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\TwoActions_I.png">  (<a href="Traits.aspx?ID=134"><u>primal</a></u>, <a href="Traits.aspx?ID=117"><u>necromancy</a></u>, <a href="Traits.aspx?ID=125"><u>plant</a></u>) Treerazer exudes a pulse of sickly green light in a 30-foot-radius emanation. All plants in the area (including creatures under the effect of his aura of corruption) blacken and wither. Non-creature plants immediately wither and die. Plant creatures take 20d8 negative damage with a DC 49 basic Fortitude save. A creature that fails its save is doomed 1 for 1 minute and sickened 3. Treerazer can choose to exclude any number of plants in the area from this effect, and generally does so to preserve twisted and corrupted plants or fungi, or plant creatures that are allied to his cause. Treerazer can't use Defoliation for 1d4 rounds.</span><span class="hanging-indent"><b>Dispelling Strike</b> <img class="actiondark" alt="Free Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\FreeAction.png"><img class="actionlight" alt="Free Action" style="height:15px; padding:0px 2px 0px 2px" src="Images\Actions\FreeAction_I.png">  (<a href="Traits.aspx?ID=2"><u>abjuration</a></u>, <a href="Traits.aspx?ID=134"><u>primal</a></u>) <b>Frequency</b> once per round; <b>Trigger</b> Treerazer hits a creature, object, or spell effect with a weapon Strike or a defoliation attack. <b>Effect</b> Treerazer casts his innate dispel magic, targeting the creature he hit with his Strike or one spell affecting that creature.</span><span class="hanging-indent"><b>Staggering Strike</b> When Treerazer scores a critical hit with a melee attack, the target is stunned 2.</span>`;
  const fields = speedsParser(input);

  expect(fields.speed).toEqual([
    { type: 'Land', amount: 60, misc: null },
    { type: 'fly', amount: 60, misc: null },
    { type: 'swim', amount: 40, misc: null },
    { type: 'freedom of movement', amount: null, misc: null },
  ]);
});
